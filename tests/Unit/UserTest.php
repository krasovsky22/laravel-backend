<?php

namespace Tests\Unit;

use App\User;
use Illuminate\Foundation\Testing\DatabaseMigrations;
use Laravel\Passport\Passport;
use Tests\TestCase;
use UsersTableSeeder;

class UserTest extends TestCase
{
    use DatabaseMigrations;

    public function setUp(): void
    {
        parent::setUp(); // TODO: Change the autogenerated stub

        $this->seed(UsersTableSeeder::class);

        Passport::actingAs(
            factory(User::class)->create()
        );
    }

    /**
     * A basic unit test example.
     *
     * @return void
     */
    public function testUsersController()
    {
        $response = $this->get('/api/users');
        $response->assertStatus(200);

        //should have data key
        $response->assertJson(['data' => true]);

        $response = $this->get('/api/users/1');
        $response->assertStatus(200);

        //should have data key
        $response->assertJson(['data' => true]);
    }

    public function testUsersDatabase()
    {
        $users = User::all();
        $this->assertGreaterThanOrEqual(UsersTableSeeder::USERS_NUMBER, count($users));
    }

}
